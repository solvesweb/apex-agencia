---
// src/components/PlayerCard.astro (o shared/PlayerCard.astro si reorganizaste)
import { Image } from "astro:assets";
import type { Player } from "../types/Player";
import { calculateAge } from "../utils/date";
import { getLangFromUrl, useTranslations } from "../i18n/utils";

interface Props {
    player: Player;
}

const { player } = Astro.props;
const age = calculateAge(player.birthDate);
const flagUrl = `https://flagcdn.com/w40/${player.countryCode}.png`;
const clubLogoUrl = `/images/clubs/TCM1_${player.clubId}.png`;

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const basePath = lang === "es" ? "" : "/en";
const profilePath = lang === "es" ? "representados" : "represented";
---

<a
    href={`${basePath}/${profilePath}/${player.slug}`}
    class="player-card group relative block overflow-hidden rounded-2xl bg-gray-900 transition-all duration-300 hover:-translate-y-2 hover:shadow-2xl"
>
    <!-- Imagen de fondo -->
    <div class="aspect-3/4 overflow-hidden">
        <Image
            src={player.image}
            alt={player.name}
            width={400}
            height={533}
            class="h-full w-full object-cover grayscale transition-all duration-500 group-hover:scale-105 group-hover:grayscale-0"
        />
    </div>

    <!-- Overlay oscuro -->
    <div
        class="absolute inset-0 bg-linear-to-t from-black/90 via-black/40 to-transparent"
    >
    </div>

    <!-- Contenido -->
    <div class="absolute inset-x-0 bottom-0 p-6 text-white">
        <!-- Club con escudo -->
        <div class="mb-3 flex items-center gap-2">
            <Image
                src={clubLogoUrl}
                alt={player.club}
                width="64"
                height="64"
                class="h-6 w-6 object-contain opacity-60 grayscale transition-all duration-500 group-hover:opacity-100 group-hover:grayscale-0"
                loading="lazy"
            />
            <div class="h-0.5 w-6 bg-primary-500"></div>
            <span
                class="text-xs font-medium uppercase tracking-wider text-gray-300"
            >
                {player.club}
            </span>
        </div>

        <!-- Nombre -->
        <h3 class="mb-4 text-3xl font-bold leading-tight font-space">
            {player.name}
        </h3>

        <!-- Info adicional -->
        <div class="flex items-center gap-4 text-sm text-gray-300">
            <!-- Solo bandera -->
            <img
                src={flagUrl}
                alt={player.nationality}
                class="h-4 w-6 rounded object-cover"
                loading="lazy"
            />

            <!-- PosiciÃ³n traducida -->
            <div class="rounded-full bg-white/10 px-3 py-1 backdrop-blur-sm">
                {t(`positions.${player.positionKey}`)}
            </div>

            <!-- Edad -->
            <span>{age} {t("common.years")}</span>
        </div>
    </div>
</a>
